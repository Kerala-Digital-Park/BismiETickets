<%- include('./partials/header') %>

<!-- **************** MAIN CONTENT START **************** -->
<main>
	
    <!-- =======================
    Main Content START -->
    <section class="vh-xxl-100">
        <div class="container h-100 d-flex px-0 px-sm-4">
            <div class="row justify-content-center align-items-center m-auto">
                <div class="col-12">
                    <div class="bg-mode shadow rounded-3 overflow-hidden">
                        <div class="row g-0">
                            <!-- Vector Image -->
                            <div class="col-lg-6 d-flex align-items-center order-2 order-lg-1">
                                <div class="p-3 p-lg-5">
                                    <img src="<%= signinImg ? signinImg : '/assets/images/element/signin.jpg' %>" alt="">
                                </div>
                                <!-- Divider -->
                                <div class="vr opacity-1 d-none d-lg-block"></div>
                            </div>
            
                            <!-- Information -->
                            <div class="col-lg-6 order-1">
                                <div class="p-4 p-sm-7">
                                    <!-- Logo -->
                                    <a href="/">
                                        <img class="h-50px mb-4" src="/assets/images/logo-light.svg" alt="logo">
                                    </a>
                                    <!-- Title -->
                                    <h1 class="mb-2 h3">Admin Login</h1>
                                    <% if (message) { %>
                                        <div class="alert alert-<%= messageType === 'success' ? 'success' : 'danger' %>" role="alert">
                                          <%= message %>
                                        </div>
                                      <% } %>

                                    <!-- Form START -->
                                    <form class="mt-4 text-start" id="login-form">
                                        <!-- Email -->
                                        <div class="mb-3">
                                            <label class="form-label">Enter email address</label>
                                            <input type="email" class="form-control" name="email" id="email">
                                        </div>
                                        <!-- Password -->
                                        <div class="mb-3 position-relative">
                                            <label class="form-label">Enter password</label>
                                            <input class="form-control fakepassword" type="password" id="psw-input" name="password">
                                            <span class="position-absolute top-50 end-0 translate-middle-y p-0 mt-3">
                                                <i class="fakepasswordicon fas fa-eye-slash cursor-pointer p-2"></i>
                                            </span>
                                        </div>
                                        <!-- Remember me -->
                                        <div class="mb-3 d-sm-flex" style="float: inline-end;">
                                            <!-- <a href="/forgot-password">Forgot password?</a> -->
                                        </div>
                                        <!-- Button -->
                                        <div><button type="submit" class="btn btn-primary w-100 mb-0" id="login-btn">Login</button></div>
            
                                        <!-- Copyright -->
                                        <div class="text-primary-hover text-body mt-3 text-center">
                                            Copyrights Â©2025 BismiETickets. Build by <a
                                                href="https://www.keraladigitalpark.com/"
                                                class="text-body">Kerala Digital Park</a>.
                                        </div>
                                    </form>
                                    <!-- Form END -->
                                </div>		
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const passwordInput = document.getElementById("psw-input");
            const toggleIcon = document.querySelector(".fakepasswordicon");
        
            if (toggleIcon) {
                toggleIcon.addEventListener("click", function () {
                    if (passwordInput.type === "password") {
                        passwordInput.type = "text";
                        toggleIcon.classList.remove("fa-eye-slash");
                        toggleIcon.classList.add("fa-eye");
                    } else {
                        passwordInput.type = "password";
                        toggleIcon.classList.remove("fa-eye");
                        toggleIcon.classList.add("fa-eye-slash");
                    }
                });
            }
        });
        </script>

        <script>
    document.getElementById("login-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    
    const email = document.getElementById("email").value;
    const password = document.getElementById("psw-input").value;

    const res = await fetch("/admin/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });

    const data = await res.json();
    if (data.success) {
      window.location.href = "/admin/";
    } else {
      Swal.fire({
        icon: 'error',
        title: 'Login Failed',
        text: data.message || 'Invalid credentials',
        confirmButtonText: 'Try Again'
      });
    }
  });
        </script>
        
    <!-- =======================
    Main Content END -->
    
    </main>
    <!-- **************** MAIN CONTENT END **************** -->
